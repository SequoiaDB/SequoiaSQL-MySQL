--- sql_parse.cc	2020-06-29 14:29:36.641836357 +0800
+++ sql_parse_modified.cc	2020-06-29 14:29:36.953836348 +0800
@@ -5003,6 +5003,15 @@
       thd->reset_query_for_display();
     }
   }
+#ifndef EMBEDDED_LIBRARY
+  else {
+    mysql_audit_notify(thd,
+                      first_level ? MYSQL_AUDIT_QUERY_STATUS_END :
+                                    MYSQL_AUDIT_QUERY_NESTED_STATUS_END,
+                      first_level ? "MYSQL_AUDIT_QUERY_STATUS_END" :
+                                    "MYSQL_AUDIT_QUERY_NESTED_STATUS_END");
+  }
+#endif /* !EMBEDDED_LIBRARY */
 
   lex->unit->cleanup(true);
   /* Free tables */
