#Case 23693 #23694

CREATE DATABASE test_sql_pushdown;
USE test_sql_pushdown;

SHOW VARIABLES LIKE "sequoiadb_execute_only_in_mysql";
SET SESSION sequoiadb_sql_push_down = ON;
CREATE TABLE t1 (a int, b int, c int, key(a), key(b)); 
INSERT INTO t1 VALUES (1,3,0), (2,2,0), (3,2,0); 
#seqDB-23693
# execute failed
--error ER_PARSE_ERROR
/*+sql_pushdown=sdb*/ INSERT INTO test_sql_pushdown.t1 VALUES (10,10,10); 
SELECT * FROM test_sql_pushdown.t1 ORDER BY a;
SHOW VARIABLES LIKE "sequoiadb_execute_only_in_mysql";
# execute failed
--error ER_PARSE_ERROR
/*+sql_pushdown=sdb*/ INSERT INTO test_sql_pushdown.t1 VALUES (20,20,20); SELECT * FROM test_sql_pushdown.t1; 
SHOW VARIABLES LIKE "sequoiadb_execute_only_in_mysql";
#seqDB-23694
# execute failed
--error ER_PARSE_ERROR
PREPARE stmt1 FROM "SELECT /*+sql_pushdown=sdb*/ a FROM test_sql_pushdown.t1 WHERE a > 1";
SELECT * FROM test_sql_pushdown.t1 ORDER BY a;
SHOW VARIABLES LIKE "sequoiadb_execute_only_in_mysql";
SET SESSION sequoiadb_sql_push_down = DEFAULT;

DROP DATABASE test_sql_pushdown;
