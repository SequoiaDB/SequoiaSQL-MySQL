##BUG #SEQUOIASQLMAINSTREAM-826
##case 22934
#
#--source include/have_sequoiadb.inc
#--source suite/metadata_sync_sequoiadb/inc/insts_connect_sequoiadb.inc
#
## connect to conn1, clear databases in the beginning
#connection conn1;
#--disable_warnings
#DROP DATABASE IF EXISTS metaSync_seq;
#--enable_warnings
#
## connect to conn2, check databases are cleaned in the beginning
#connection conn2;
#--sleep $sleep
#--error ER_BAD_DB_ERROR
#SHOW CREATE DATABASE metaSync_seq;
#
## seqDB-22934
## begin testing
##
## create/alter/drop sequence
#connection conn1;
#CREATE DATABASE metaSync_seq;
#USE metaSync_seq;
#CREATE SEQUENCE IF NOT EXISTS seq1 ENGINE InnoDB MAX_ROWS 10 MIN_ROWS 1 ROW_FORMAT = REDUNDANT SEQUENCE = 1 COMMENT 'create sequence';
##CREATE TEMPORARY SEQUENCE seq2 INCREMENT BY -1 CACHE 100 ENGINE InnoDB;
#CREATE SEQUENCE seq3 INCREMENT BY 1 CACHE 1 ENGINE InnoDB;
#CREATE OR REPLACE SEQUENCE seq3 CYCLE INCREMENT BY -1 ENGINE InnoDB;
## check metadatas after create
#connection conn2;
#--sleep $sleep
#USE metaSync_seq;
#SHOW CREATE TABLE seq1;
#SHOW CREATE TABLE seq3;
#SELECT * FROM seq1;
#SELECT * FROM seq3;
#SELECT NEXT VALUE FOR seq1;
#SELECT PREVIOUS VALUE FOR seq1;
#SELECT NEXT VALUE FOR seq3;
## alter sequence
#ALTER SEQUENCE seq1 START = 15 RESTART MINVALUE = 10 MAXVALUE = 20 CYCLE;
#ALTER SEQUENCE seq3 INCREMENT BY -5 START WITH -5 MINVALUE=-100000 no MAXVALUE NOCYCLE;
#RENAME TABLE seq3 to seq3_new;
## check metadatas after alter
#connection conn1;
#--sleep $sleep
#SELECT * FROM seq1;
#--error ER_NO_SUCH_TABLE
#SHOW CREATE TABLE seq3;
#SELECT * FROM seq3_new;
#SELECT NEXT VALUE FOR seq1;
#SELECT NEXT VALUE FOR seq3_new;
## drop sequence 
#DROP SEQUENCE IF EXISTS seq1;
#DROP SEQUENCE seq3_new;
#DROP SEQUENCE /* sequence does not exists */ IF EXISTS seq3_new;
## check metadatas after drop
#connection conn2;
#--sleep $sleep
#--error ER_NO_SUCH_TABLE
#SHOW CREATE TABLE seq1;
#--error ER_NO_SUCH_TABLE
#SHOW CREATE TABLE seq3;
#--error ER_NO_SUCH_TABLE
#SHOW CREATE TABLE seq3_new;
#
## clear databases in the ending
#connection conn1;
#DROP DATABASE metaSync_seq;
## check databases are cleaned in the ending
#connection conn2;
#--sleep $sleep
#--error ER_BAD_DB_ERROR
#SHOW CREATE DATABASE metaSync_seq;
#
#--source include/uninstall_sequoiadb.inc
#--source suite/metadata_sync_sequoiadb/inc/insts_disconnect_sequoiadb.inc
