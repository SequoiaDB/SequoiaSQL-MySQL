#Case 23285


--source include/have_sequoiadb.inc
--source suite/metadata_sync_sequoiadb/inc/insts_connect_sequoiadb.inc

# connect to conn1, clear databases in the beginning
connection conn1;
--disable_warnings
DROP DATABASE IF EXISTS metaSync_23285;
--enable_warnings

# connect to conn2, check databases are cleaned in the beginning
connection conn2;
--sleep $sleep
--error ER_BAD_DB_ERROR
SHOW CREATE DATABASE metaSync_23285;

#seqDB-23285
# begin testing
#
# CREATE TABLES AND SEQUENCES
#
connection conn1;
CREATE DATABASE metaSync_23285;
USE metaSync_23285;
CREATE SEQUENCE st1; 
CREATE TABLE a1 ( id int default next value for st1 ); 
CREATE TABLE b1 ( id int default next value for st1 ); 
CREATE SEQUENCE st2; 
CREATE TABLE c1 ( id int default next value for st2 ); 
CREATE SEQUENCE st3; 
CREATE TABLE d1 ( id int default next value for st3 ); 
# check metadatas after create
connection conn2;
--sleep $sleep
USE metaSync_23285;
SHOW CREATE TABLE a1;
SHOW CREATE TABLE b1;
SHOW CREATE TABLE c1;
SHOW CREATE TABLE d1;
SHOW CREATE TABLE st1;
SHOW CREATE TABLE st2;
SHOW CREATE TABLE st3;
# clear tables
connection conn1;
DROP TABLE a1,b1,c1,d1,st1,st2,st3;
# check tables cleared
connection conn2;
--sleep $sleep
--error ER_NO_SUCH_TABLE
SHOW CREATE TABLE a1; 
--error ER_NO_SUCH_TABLE
SHOW CREATE TABLE b1; 
--error ER_NO_SUCH_TABLE
SHOW CREATE TABLE c1; 
--error ER_NO_SUCH_TABLE
SHOW CREATE TABLE d1; 
--error ER_NO_SUCH_TABLE
SHOW CREATE TABLE st1;
--error ER_NO_SUCH_TABLE
SHOW CREATE TABLE st2;
--error ER_NO_SUCH_TABLE
SHOW CREATE TABLE st3;
# clear databases in the ending
connection conn1;
DROP DATABASE metaSync_23285;
# check databases are cleaned in the ending
connection conn2;
--sleep $sleep
--error ER_BAD_DB_ERROR 
SHOW CREATE DATABASE metaSync_23285;

--source include/uninstall_sequoiadb.inc
--source suite/metadata_sync_sequoiadb/inc/insts_disconnect_sequoiadb.inc
